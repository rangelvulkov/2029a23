<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DualPay Calculator 2029a23</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Montserrat', sans-serif; background-color: #e0f2fe; overflow: hidden; }
        h1, .logo-text { font-family: 'Comfortaa', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); border-radius: 24px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); }
        .bg-symbols { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; opacity: 0.15; }
        .float-symbol { position: absolute; animation: float 15s infinite linear; font-size: 2rem; color: #0369a1; }
        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg) scale(1); }
            50% { transform: translate(100px, 100px) rotate(180deg) scale(1.2); }
            100% { transform: translate(0, 0) rotate(360deg) scale(1); }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">
    <div class="bg-symbols" id="symbols-container"></div>

    <main class="glass w-full max-w-md p-8 relative">
        <div class="flex items-center justify-center mb-6">
            <div class="w-12 h-12 bg-[#0369a1] rounded-xl flex items-center justify-center text-white mr-3 shadow-lg">
                <span class="logo-text text-xl">€⇄лв</span>
            </div>
            <h1 class="text-2xl text-[#0369a1]">DualPay</h1>
        </div>

        <div class="space-y-4">
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-1">Сума за плащане</label>
                <div class="flex">
                    <input type="number" id="billAmount" class="w-full p-3 rounded-l-xl border-none focus:ring-2 focus:ring-[#0369a1]" placeholder="0.00">
                    <select id="billCurrency" class="bg-gray-100 p-3 rounded-r-xl border-none">
                        <option value="BGN">BGN</option>
                        <option value="EUR">EUR</option>
                    </select>
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-1">Платено в лв.</label>
                    <input type="number" id="paidBGN" class="w-full p-3 rounded-xl border-none focus:ring-2 focus:ring-[#0369a1]" placeholder="0.00">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-1">Платено в €</label>
                    <input type="number" id="paidEUR" class="w-full p-3 rounded-xl border-none focus:ring-2 focus:ring-[#0369a1]" placeholder="0.00">
                </div>
            </div>

            <div id="resultBox" class="p-4 rounded-xl hidden transition-all duration-500">
                <div class="text-sm font-semibold mb-1" id="resultLabel">Ресто:</div>
                <div class="text-2xl font-bold" id="mainChange">0.00 EUR</div>
                <div class="text-sm opacity-80" id="subChange">Еквивалент: 0.00 BGN</div>
            </div>
        </div>

        <footer class="mt-8 text-center text-[10px] text-gray-500">
            <p>Курс: 1 EUR = 1.95583 BGN</p>
            <p class="mt-1">© [ТВОЕТО ИМЕ]</p>
        </footer>
    </main>

    <script>
        const RATE = 1.95583;
        const symbols = ['€', 'лв', '€', 'лв'];
        const container = document.getElementById('symbols-container');

        // Генериране на фон
        for (let i = 0; i < 20; i++) {
            const span = document.createElement('span');
            span.className = 'float-symbol';
            span.innerText = symbols[Math.floor(Math.random() * symbols.length)];
            span.style.left = Math.random() * 100 + 'vw';
            span.style.top = Math.random() * 100 + 'vh';
            span.style.animationDelay = Math.random() * 10 + 's';
            container.appendChild(span);
        }

        function calculate() {
            const bill = parseFloat(document.getElementById('billAmount').value) || 0;
            const billCurr = document.getElementById('billCurrency').value;
            const paidBGN = parseFloat(document.getElementById('paidBGN').value) || 0;
            const paidEUR = parseFloat(document.getElementById('paidEUR').value) || 0;

            const billInBGN = billCurr === 'EUR' ? bill * RATE : bill;
            const totalPaidInBGN = paidBGN + (paidEUR * RATE);
            const changeInBGN = totalPaidInBGN - billInBGN;

            const resBox = document.getElementById('resultBox');
            if (bill > 0) {
                resBox.classList.remove('hidden');
                if (changeInBGN < 0) {
                    resBox.className = 'p-4 rounded-xl bg-red-100 text-red-700 mt-4';
                    document.getElementById('resultLabel').innerText = 'Недостиг:';
                    document.getElementById('mainChange').innerText = Math.abs(changeInBGN).toFixed(2) + ' BGN';
                    document.getElementById('subChange').innerText = 'или ' + (Math.abs(changeInBGN) / RATE).toFixed(2) + ' EUR';
                } else {
                    resBox.className = 'p-4 rounded-xl bg-green-100 text-green-700 mt-4';
                    document.getElementById('resultLabel').innerText = 'Ресто (приоритет EUR):';
                    const changeInEUR = changeInBGN / RATE;
                    document.getElementById('mainChange').innerText = changeInEUR.toFixed(2) + ' EUR';
                    document.getElementById('subChange').innerText = 'Еквивалент: ' + changeInBGN.toFixed(2) + ' BGN';
                }
            } else {
                resBox.classList.add('hidden');
            }
        }

        document.querySelectorAll('input, select').forEach(el => el.addEventListener('input', calculate));

        // PWA Service Worker
        const swCode = `
            self.addEventListener('install', e => e.waitUntil(caches.open('v1').then(c => c.addAll(['/']))));
            self.addEventListener('fetch', e => e.respondWith(caches.match(e.request).then(r => r || fetch(e.request))));
        `;
        const blob = new Blob([swCode], {type: 'application/javascript'});
        const workerUrl = URL.createObjectURL(blob);
        if ('serviceWorker' in navigator) { navigator.serviceWorker.register(workerUrl); }
    </script>
</body>
</html>

